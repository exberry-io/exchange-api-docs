# Dealer Trading

## submitQuote

The `submitQuote` API is used to respond to an RFQ by creating a new Quote in the exchange. Multiple Quotes can be created for a single RFQ.

A response is received with `quoteStatus=Accepted` if the request is valid. This means the Quote passed all validations and was accepted by the system. The response contains `quoteId`, the unique identifier the system generates. An invalid `submitQuote` request is rejected with an error message.

In case a response is not received within the timeout window, user can

1. **Retry** using the same `mpQuoteId` which will result
   * Rejection in case that previous Quote was accepted
   * Success in case that previous Quote was not accepted
2. **Cancel** the Quote using `mpQuoteId`

`mpQuoteId` is a unique identifier and should not be used for more than one Quote. Note: system might accept already used `mpQuoteId` after predefined period but it is not recommended to use same `mpQuoteId` twice.

{% hint style="info" %}
qualifier: v1/exchange.market/submitQuote
{% endhint %}



### **Request**

<table><thead><tr><th width="254">Parameter</th><th width="115.33333333333331">Type</th><th>Description</th></tr></thead><tbody><tr><td>mpQuoteId</td><td>Long</td><td>Market participant’s id for the Quote</td></tr><tr><td>instrument</td><td>String</td><td>Instrument symbol</td></tr><tr><td>rfqId</td><td>Long</td><td><p>Unique id generated by the system for the RFQ.</p><p>The Quote will be in response to the RFQ identified by this Id.</p></td></tr><tr><td>quoteDetails</td><td>[] Object</td><td>Array of quoteDetail objects, see details below.<br><em>Currently only one object is allowed.</em></td></tr><tr><td>accountType</td><td>Enum</td><td>Account type Client or House</td></tr><tr><td>parties</td><td>[] Object</td><td>Array of party objects, see details below.<br>Max number of parties =20 </td></tr></tbody></table>

quoteDetail specification:

<table><thead><tr><th width="112">Name</th><th width="165.33333333333331">Type</th><th>Description</th></tr></thead><tbody><tr><td>side</td><td>String</td><td><p>Side of the Quote</p><p>One of the below options:</p><ul><li>Buy - Quote to buy the instrument </li><li>Sell - Quote to sell the instrument</li></ul></td></tr><tr><td>price</td><td>Decimal</td><td>price of the quoted side</td></tr><tr><td>quantity</td><td>Decimal</td><td>quantity of the quoted side<br><em>Currently quantity should be same as RFQ quantity.</em></td></tr></tbody></table>

Sample:

```json
    "quoteDetails": [
      {
        "side": "Sell",
        "price": "15",
        "quantity": 1200
      }
    ]
```



Party specification:&#x20;

<table><thead><tr><th width="112">Name</th><th width="165.33333333333331">Type</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>String</td><td>Party id<br>Max length = 20 </td></tr><tr><td>source</td><td>Char</td><td>Party source</td></tr><tr><td>role</td><td>Int</td><td>Party role </td></tr></tbody></table>

Sample:

```json
    "parties": [
      {
        "id": "ID123",
        "source": "D",
        "role": 12
      },
      {
        "id": "user123",
        "source": "D",
        "role": 13
      }
    ]
```



### **Response**

| Parameter   | Type   | Description                                     |
| ----------- | ------ | ----------------------------------------------- |
| quoteId     | Long   | Unique id generated by the system for the Quote |
| quoteStatus | String | RFQ status: ‘Accepted’                          |



### **Error Codes**

<table><thead><tr><th width="128">Code</th><th>Message</th></tr></thead><tbody><tr><td>1</td><td><code>Exchange is unavailable</code></td></tr><tr><td>1000</td><td><code>Missing fields: [Fieldname]</code> or<br><code>Party of source=[ConfiguredParty.source] and role=[ConfiguredParty.role] is required</code></td></tr><tr><td>1001</td><td><p><code>[FieldName] must be > 0</code> or</p><p><code>Wrong mpQuoteId</code> or</p><p><code>[FieldName] must be ≤ [maxLong/10^ fieldPrecision]</code> or</p><p><code>[FieldName] must ≥ [minLong/10^ fieldPrecision]</code> or</p><p><code>Wrong [FieldName]</code> or</p><p><code>RFQ is not allowed in the instrument</code> or<br><code>[FieldName] must be = [RFQ.quantity]</code> or<br><code>[required side] side Quote is required</code></p></td></tr><tr><td>1002</td><td><code>mpQuoteId is already in use</code></td></tr><tr><td>1003</td><td><code>Market is closed</code></td></tr><tr><td>1004</td><td><code>Instrument trading is not allowed</code></td></tr><tr><td>1005</td><td><code>Quantity precision is [QuantityPrecision]</code></td></tr><tr><td>1006</td><td><code>Minimum quantity is [MinOrderQuantity]</code> or<br><code>Maximum quantity is [MaxOrderQuantity]</code> or<br><code>Quantity increment is [quantityIncrement]</code></td></tr><tr><td>1007</td><td><code>Invalid session</code></td></tr><tr><td>1008</td><td><code>Insufficient permissions</code></td></tr><tr><td>1009</td><td><code>Instrument trading is halted</code></td></tr><tr><td>1010</td><td><code>Instrument [Instrument] not found</code></td></tr><tr><td>1011</td><td><code>Permission denied for this instrument</code></td></tr><tr><td>1012</td><td><code>Price breaches [FieldName] of [FieldValue]</code></td></tr><tr><td>1013</td><td><code>Maximum Quote value is [maxOrderValue]</code></td></tr><tr><td>1014</td><td><code>Price tick size is [tickSize]</code></td></tr><tr><td>1018</td><td><code>Trading is not allowed</code></td></tr><tr><td>1032</td><td><code>Account not found</code> or<br><code>Party is not allowed</code></td></tr><tr><td>1041</td><td><code>RFQ [rfqId] not found</code></td></tr></tbody></table>



### **Samples**

{% tabs %}
{% tab title="Request" %}
```json
{
  "q": "v1/exchange.market/submitQuote",
  "sid": 1,
  "d": {
    "mpQuoteId" : 1003,
        "quoteDetails": [
      {
      "side":"Sell",
      "price":15.23,
      "quantity":1300
      }],
    "instrument": "RFQINST2",
    "rfqId": 1,
  }
}
```
{% endtab %}

{% tab title="Success Response" %}
```javascript
{
  "q": "v1/exchange.market/submitQuote",
  "sid": 1,
  "d": {
    "quoteId": 1234,
    "quoteStatus": "Accepted"
  }
}
```
{% endtab %}

{% tab title="Failure Response" %}
```javascript
{
  "sig": 2,
  "q": "v1/exchange.market/submitQuote",
  "errorType": "500",
  "sid": 1,
  "d": {
    "errorCode": 1010,
    "errorMessage": "Instrument AMZ11 not found"
  }
}
```
{% endtab %}
{% endtabs %}



## cancelQuote

The `cancelQuote` API is used by the Quote dealer to cancel a Quote.&#x20;

A response is received with `quoteId` if the request is successful. This means the request passed all validations, and the Quote has been cancelled. An invalid `cancelQuote` request is rejected with an error message.

In case a response is not received within the timeout window, user can

1. **Retry** using the same parameters which will result
   * Rejection in case that previous request was accepted
   * Success in case that previous request was not accepted

{% hint style="info" %}
qualifier: v1/exchange.market/cancelQuote
{% endhint %}



### **Request**

<table><thead><tr><th width="254">Parameter</th><th width="115.33333333333331">Type</th><th>Description</th></tr></thead><tbody><tr><td>mpQuoteId</td><td>Long</td><td><p>Market participant’s id for the quote,</p><p>Not mandatory if quoteId was sent.</p></td></tr><tr><td>quoteId</td><td>Long</td><td><p>Unique id generated by the system for the Quote.</p><p>Not mandatory if mpQuoteId was sent.</p></td></tr><tr><td>instrument</td><td>String</td><td>Instrument symbol</td></tr></tbody></table>



### **Response**

| Parameter | Type | Description                                     |
| --------- | ---- | ----------------------------------------------- |
| quoteId   | Long | Unique id generated by the system for the Quote |



### **Error Codes**

<table><thead><tr><th width="128">Code</th><th>Message</th></tr></thead><tbody><tr><td>1</td><td><code>Exchange is unavailable</code></td></tr><tr><td>1001</td><td><p><code>Wrong [FieldName]</code> or</p><p><code>RFQ is not allowed in the instrument</code> or</p></td></tr><tr><td>1003</td><td><code>Market is closed</code></td></tr><tr><td>1004</td><td><code>Instrument trading is not allowed</code></td></tr><tr><td>1007</td><td><code>Invalid session</code></td></tr><tr><td>1008</td><td><code>Insufficient permissions</code></td></tr><tr><td>1009</td><td><code>Instrument trading is halted</code></td></tr><tr><td>1010</td><td><code>Instrument [Instrument] not found</code></td></tr><tr><td>1011</td><td><code>Permission denied for this instrument</code></td></tr><tr><td>1018</td><td><code>Trading is not allowed</code></td></tr><tr><td>1100</td><td><code>Quote not found for that instrument</code></td></tr><tr><td>1103</td><td><code>Missing fields: [Fieldname]</code></td></tr><tr><td>1104</td><td><code>Please use only one from quoteId or mpQuoteId</code></td></tr></tbody></table>



### **Samples**

{% tabs %}
{% tab title="Request" %}
```json
{
  "q": "v1/exchange.market/cancelRFQ",
  "sid": 1,
  "d": {
    "rfqId": 123,
    "instrument": "ABC",
    }
}
```
{% endtab %}

{% tab title="Success Response" %}
```javascript
{
  "q": "v1/exchange.market/cancelRFQ",
  "sid": 1,
  "d": {
    "rfqId": 678
  }
}
```
{% endtab %}

{% tab title="Failure Response" %}
```javascript
{
  "sig": 2,
  "q": "v1/exchange.market/cancelRFQ",
  "errorType": "500",
  "sid": 1,
  "d": {
    "errorCode": 1010,
    "errorMessage": "Instrument AMZ11 not found"
  }
}
```
{% endtab %}
{% endtabs %}



