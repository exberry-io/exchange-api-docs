# Operations

## Credit

This API allows increasing the account balance of an asset by the input amount. The balance is immediately updated without going through a workflow.

{% hint style="info" %}
\[POST] {Admin REST}/api/accounts/{Account.id}/credit
{% endhint %}

### Request

<table><thead><tr><th width="186.0869140625">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>type</td><td>eNum</td><td><p>Transaction Type<br></p><p>Allowed values:</p><p>- Deposit</p><p>- Adjustment</p></td></tr><tr><td>ledgerAccountId</td><td>Int</td><td>Ledger Account to credit</td></tr><tr><td>assetId</td><td>Int</td><td>Asset to credit</td></tr><tr><td>amount</td><td>Decimal</td><td>Credit amount</td></tr><tr><td>description <code>Optional</code></td><td>String</td><td>Description</td></tr></tbody></table>

### **Response**

<table><thead><tr><th width="186.0869140625">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>transactionId</td><td>Int</td><td>Transaction Id generated by the system</td></tr><tr><td>ledgerAccountId</td><td>Int</td><td>Same as the request</td></tr><tr><td>assetId</td><td>Int</td><td>Same as the request</td></tr><tr><td>availableBalance</td><td>Decimal</td><td>availableBalance of the asset in the ledger account</td></tr><tr><td>reservedBalance</td><td>Decimal</td><td>reservedBalance of the asset in the ledger account</td></tr><tr><td>totalBalance</td><td>Decimal</td><td>totalBalance of the asset in the ledger account</td></tr></tbody></table>

### **Error Codes**

<table><thead><tr><th width="128">Code</th><th>Message</th></tr></thead><tbody><tr><td>1</td><td><code>System is unavailable</code></td></tr><tr><td>100</td><td><code>Missing or invalid parameter: [FieldName]</code></td></tr><tr><td>101</td><td><code>[FieldName] must be less than or equal to maxLong/10^ fieldPrecision</code><br><code>Amount*conversionFactor must be less than or equal to [(maxLong/10^ Asset.Precision - Asset.totalBalance)]</code><br><code>Minimum Deposit is [Asset.minDeposit]</code><br><code>Amount should be an increment of [inOutIncrement]</code></td></tr><tr><td>102</td><td><p><code>Trading is not allowed</code></p><p><code>Not allowed</code></p></td></tr><tr><td>10001</td><td><code>Permission denied</code></td></tr></tbody></table>

### **Samples**

{% tabs %}
{% tab title="Request" %}
```json
curl --location 'https://admin-api-master.rnd.exberry-rnd.io/api/accounts/516/credit' \
--header 'Content-Type: application/json' \
--header 'Authorization: ••••••' \
--data '{
  "type": "Deposit",
  "assetId": "44",
  "amount": "5000",
  "description": "Initial Deposit"
}'
```
{% endtab %}

{% tab title="Success Response" %}
```json
{
    "transactionId": "7999",
    "ledgerAccountId": "516",
    "assetId": "44",
    "availableBalance": "5000",
    "reservedBalance": "0",
    "totalBalance": "5000"
}
```
{% endtab %}

{% tab title="Failure Response" %}
```json
{
    "code": "100",
    "message": "Missing or invalid parameter: amount"
}
```
{% endtab %}
{% endtabs %}



## Debit

This API allows decreasing the account balance of an asset by the input amount. The balance is immediately updated without going through a workflow.

{% hint style="info" %}
\[POST] {Admin REST}/api/accounts/{Account.id}/debit
{% endhint %}

### Request

<table><thead><tr><th width="186.0869140625">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>type</td><td>eNum</td><td><p>Transaction Type<br></p><p>Allowed values:</p><p>- Withdrawal</p><p>- Redemption</p><p>- Adjustment</p></td></tr><tr><td>ledgerAccountId</td><td>Int</td><td>Ledger Account to debit</td></tr><tr><td>assetId</td><td>Int</td><td>Asset to debit</td></tr><tr><td>amount</td><td>Decimal</td><td>Debit amount</td></tr><tr><td>description <code>Optional</code></td><td>String</td><td>Description</td></tr></tbody></table>

### **Response**

Same as the response of Credit

### **Error Codes**

<table><thead><tr><th width="128">Code</th><th>Message</th></tr></thead><tbody><tr><td>1</td><td><code>System is unavailable</code></td></tr><tr><td>100</td><td><code>Missing or invalid parameter: [FieldName]</code></td></tr><tr><td>101</td><td><code>Minimum Withdrawal is [Asset.minDeposit]</code><br><code>Amount should be an increment of [inOutIncrement]</code></td></tr><tr><td>102</td><td><p><code>Trading is not allowed</code></p><p><code>Not allowed</code></p></td></tr><tr><td>200</td><td><code>Insufficient balance: [MissingAmount] [TransactionUnits] of [AssetName] are missing</code></td></tr><tr><td>10001</td><td><code>Permission denied</code></td></tr></tbody></table>

### **Samples**

{% tabs %}
{% tab title="Request" %}
```json
curl --location 'https://admin-api-master.rnd.exberry-rnd.io/api/accounts/516/debit' \
--header 'Content-Type: application/json' \
--header 'Authorization: ••••••' \
--data '{
  "type": "Withdrawal",
  "assetId": "44",
  "amount": "50",
  "description": "Fees"
}'
```
{% endtab %}

{% tab title="Success Response" %}
```json
{
    "transactionId": "8002",
    "ledgerAccountId": "516",
    "assetId": "44",
    "availableBalance": "4950",
    "reservedBalance": "0",
    "totalBalance": "4950"
}
```
{% endtab %}

{% tab title="Failure Response" %}
```json
{
    "code": "100",
    "message": "Missing or invalid parameter: amount"
}
```
{% endtab %}
{% endtabs %}

## Transfer

This API allows transferring assets between accounts. The balance is immediately updated without going through a workflow and without creating a reserve.

{% hint style="info" %}
\[POST] {Admin REST}/api/accounts/{senderAccountId}/transfer
{% endhint %}

### Request

<table><thead><tr><th width="186.0869140625">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>type</td><td>eNum</td><td><p>Transfer Type<br></p><p>Allowed values:</p><p>- DvP</p><p>- FoP</p><p>- Cash</p><p>- DvD</p></td></tr><tr><td>senderAccountId</td><td>Int</td><td>Ledger Account of the sender</td></tr><tr><td>senderAssets <code>Optional</code></td><td>Asset Object</td><td>Assets transferring from sender to receiver</td></tr><tr><td>receiverAccountId</td><td>Int</td><td>Ledger Account of the receiver</td></tr><tr><td>receiverAssets <code>Optional</code></td><td>Asset Object</td><td>Assets transferring from receiver to sender</td></tr><tr><td>description <code>Optional</code></td><td>String</td><td>Description</td></tr></tbody></table>

#### **Asset Object**

<table><thead><tr><th width="186.0869140625">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>assetId</td><td>Int</td><td>Asset Id</td></tr><tr><td>amount</td><td>Decimal</td><td>Amount of the asset in transaction units</td></tr></tbody></table>

### **Response**

<table><thead><tr><th width="186.0869140625">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>senderAccountId</td><td>Int</td><td>Same as the request</td></tr><tr><td>receiverAccountId</td><td>Int</td><td>Same as the request</td></tr><tr><td>transactionIds</td><td>[  ] Int</td><td>Transaction ids created by the transfer</td></tr></tbody></table>

### **Error Codes**

<table><thead><tr><th width="128">Code</th><th>Message</th></tr></thead><tbody><tr><td>1</td><td><code>System is unavailable</code></td></tr><tr><td>100</td><td><code>Missing or invalid parameter: [FieldName]</code></td></tr><tr><td>101</td><td><code>Minimum amount for [assetName] is [Asset.minTransfer]</code><br><code>Amount of [assetName] should be an increment of [transferIncrement]</code></td></tr><tr><td>102</td><td><code>Trading is not allowed</code><br><code>Not allowed</code></td></tr><tr><td>200</td><td><code>Insufficient balance: [Amt] [TransactionUnits] of [AssetName] are missing</code></td></tr><tr><td>10001</td><td><code>Permission denied</code></td></tr></tbody></table>

### **Samples**

{% tabs %}
{% tab title="Request" %}
```json
curl --location 'https://admin-api-master.rnd.exberry-rnd.io/api/accounts/14/transfer' \
--header 'Content-Type: application/json' \
--header 'Authorization: ••••••' \
--data '{
    "type": "DvD",
    "senderAccountId": 14,
    "receiverAccountId": 36,
    "senderAssets": [
        {
            "assetId": "10",
            "amount": "1"
        }
    ],
    "receiverAssets": [
        {
            "assetId": "97",
            "amount": "2"
        }
    ],    
  "description": "DvP transfer"
}'
```
{% endtab %}

{% tab title="Success Response" %}
```json
{
    "senderAccountId": "14",
    "receiverAccountId": "36",
    "transactionIds": [
        "8031",
        "8032",
        "8033",
        "8034"
    ]
}
```
{% endtab %}

{% tab title="Failure Response" %}
```json
{
    "code": "100",
    "message": "Missing or invalid parameter: receiverAccountId"
}
```
{% endtab %}
{% endtabs %}

## Create Transaction Request

This API allows to create a transaction request with a workflow.&#x20;

The workflow is defined in [#create-transaction-request](operations.md#create-transaction-request "mention")

{% hint style="info" %}
\[POST] {Admin REST}/api/accounts/517/transaction-requests
{% endhint %}

### Request

* If type=Deposit, Same as Credit.type=Deposit with below changes.
* If type=Withdrawal, Same as Debit.type=Withdrawal with below changes.

<table><thead><tr><th width="115.99639892578125"></th><th width="177.1981201171875">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>Changed</td><td>type</td><td>eNum</td><td><p>Transaction Request Type</p><p></p><p>Allowed values:</p><p>- Deposit</p><p>- Adjustment</p></td></tr><tr><td>Add</td><td>instructionDetailsId <code>Optional</code></td><td>uuid</td><td>Instruction Details uuid reference <br><a data-mention href="operations.md#upload-transaction-details">#upload-transaction-details</a><br><a data-mention href="operations.md#get-transaction-details-url">#get-transaction-details-url</a></td></tr><tr><td>Add</td><td>assetDetailsId <code>Optional</code></td><td>uuid</td><td>Asset Details uuid reference </td></tr></tbody></table>

### **Response**

<table><thead><tr><th width="186.0869140625">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>Int</td><td>System generated Transaction request id</td></tr><tr><td>status</td><td>String</td><td>Instructed</td></tr></tbody></table>

### **Error Codes**

* If type=Deposit, Same as Credit.type=Deposit.
* If type=Withdrawal, Same as Debit.type=Withdrawal.

### **Samples**

{% tabs %}
{% tab title="Request" %}
```json
curl --location 'https://admin-api-master.rnd.exberry-rnd.io/api/accounts/517/transaction-requests' \
--header 'Content-Type: application/json' \
--header 'Authorization: ••••••' \
--data '{
  "type": "Deposit",
  "assetId": "44",
  "amount": "50",
  "description": "Comment"
}'
```
{% endtab %}

{% tab title="Success Response" %}
```json
{
    "id": "465",
    "status": "Instructed"
}
```
{% endtab %}

{% tab title="Failure Response" %}
```json
{
    "code": "100",
    "message": "Missing or invalid parameter: amount"
}
```
{% endtab %}
{% endtabs %}

## Update Transaction Request

This API allows to update a Transactions Request in `Instructed` or `InProcess` status.

{% hint style="info" %}
\[PATCH] {Admin REST}/api/accounts/transaction-requests/{TransactionRequest.id}
{% endhint %}

### Request

<table><thead><tr><th width="186.0869140625">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>amount</td><td>Decimal</td><td>Same as Create Transaction Request</td></tr><tr><td>description</td><td>String</td><td>Same as Create Transaction Request</td></tr><tr><td>instructionDetailsId <code>Optional</code></td><td>uuid</td><td>Same as Create Transaction Request</td></tr><tr><td>assetDetailsId <code>Optional</code></td><td>uuid</td><td>Same as Create Transaction Request</td></tr></tbody></table>

### **Response**

<table><thead><tr><th width="186.0869140625">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>Int</td><td>System generated Transaction request id</td></tr><tr><td>status</td><td>String</td><td>Instructed</td></tr></tbody></table>

### **Error Codes**

* Same as Create Transaction Request with additional error codes below

<table><thead><tr><th width="128">Code</th><th>Message</th></tr></thead><tbody><tr><td>101</td><td><code>Transaction Request not found</code></td></tr></tbody></table>

### **Samples**

{% tabs %}
{% tab title="Request" %}
```json
curl --location --request PATCH 'https://admin-api-master.rnd.exberry-rnd.io/api/accounts/transaction-requests/470' \
--header 'Content-Type: application/json' \
--header 'Authorization: ••••••' \
--data '{
  "amount": "502",
  "description": "Comment for update"
}'
```
{% endtab %}

{% tab title="Success Response" %}
```json
{}
```
{% endtab %}

{% tab title="Failure Response" %}
```json
{
    "code": "101",
    "message": "Transaction Request not found"
}
```
{% endtab %}
{% endtabs %}

## Set Transaction Request Status

This API allows to do the below status transitions for Transaction Requests

1. **Approve**: From `Instructed` to `InProcess`
2. **Settle**: From `InProcess` to `Settled`
3. **Cancel**: From `Instructed` OR `InProcess` to `Cancelled`

{% hint style="info" %}
\[PATCH] {Admin REST}/api/accounts/transaction-requests/{TransactionRequest.id}/set-status
{% endhint %}

### Request

<table><thead><tr><th width="186.0869140625">Parameter</th><th width="113.95247395833331">Type</th><th>Description</th></tr></thead><tbody><tr><td>status</td><td>eNum</td><td><p>New status</p><p><br>Allowed values:</p><p>- InProcess</p><p>- Settled</p><p>- Cancelled</p></td></tr></tbody></table>

### **Response**

No response body

### **Error Codes**

<table><thead><tr><th width="128">Code</th><th>Message</th></tr></thead><tbody><tr><td>100</td><td><code>Missing or invalid parameter: [FieldName]</code></td></tr><tr><td>101</td><td><code>Transaction Request not found</code></td></tr><tr><td>10001</td><td><code>Permission denied</code></td></tr></tbody></table>

### **Samples**

{% tabs %}
{% tab title="Request" %}
```json
curl --location 'https://admin-api-master.rnd.exberry-rnd.io/api/accounts/transaction-requests/470/set-status' \
--header 'Content-Type: application/json' \
--header 'Authorization: ••••••' \
--data '{
  "status": "InProcess"
}'
```
{% endtab %}

{% tab title="Success Response" %}
```json
{}
```
{% endtab %}

{% tab title="Failure Response" %}
```json
{
    "code": "101",
    "message": "Transaction Request not found"
}
```
{% endtab %}
{% endtabs %}



## Cancel Alleged Transfer

This API allows to cancel Alleged Transfers created by MPs/Traders. Refer to the MP/Trader APIs for more details.

{% hint style="info" %}
\[PATCH] {Admin REST}/api/accounts/transaction-requests/{TransactionRequest.id}/cancel
{% endhint %}

### Request

No request body

### **Response**

No response body

### **Error Codes**

<table><thead><tr><th width="128">Code</th><th>Message</th></tr></thead><tbody><tr><td>1</td><td><code>System is unavailable</code></td></tr><tr><td>100</td><td><code>Missing or invalid parameter: [FieldName]</code></td></tr><tr><td>101</td><td><code>[FieldName] not found</code></td></tr><tr><td>10001</td><td><code>Permission denied</code></td></tr></tbody></table>

### **Samples**

{% tabs %}
{% tab title="Request" %}
```json
curl --location --request POST 'https://admin-api-master.rnd.exberry-rnd.io/api/accounts/alleged-transfers/341/cancel' \
--header 'Authorization: ••••••' \
--data ''
```
{% endtab %}

{% tab title="Success Response" %}
```json
{}
```
{% endtab %}

{% tab title="Failure Response" %}
```json
{
    "code": "101",
    "message": "Alleged transfer not found"
}
```
{% endtab %}
{% endtabs %}

